<div class="courses-container">
  <h1><i class="fas fa-graduation-cap"></i> Kurser</h1>

  <!-- Loading state -->
  <div *ngIf="loading" class="loading">
    <p>Laddar kurser...</p>
  </div>

  <!-- Filter och sortering -->
  <div *ngIf="!loading" class="filters-section">
    <!-- Sökfunktion -->
    <div class="filter-group">
      <label for="search"
        ><i class="fas fa-search"></i>Sök kurskod eller kursnamn:</label
      >
      <input
        type="text"
        id="search"
        [(ngModel)]="searchTerm"
        (input)="onSearch()"
        placeholder="T.ex. DT208G eller Datateknik..."
        class="search-input"
      />
    </div>

    <!-- Ämnesfilter -->
    <div class="filter-group">
      <label for="subject"><i class="fas fa-tags"></i> Filtrera på ämne:</label>
      <select
        id="subject"
        [(ngModel)]="selectedSubject"
        (change)="onSubjectChange()"
      >
        <option value="">Alla ämnen</option>
        <option *ngFor="let subject of subjects" [value]="subject">
          {{ subject }}
        </option>
      </select>
    </div>

    <!-- Nivåfilter -->
    <div class="filter-group">
      <label for="level"
        ><i class="fas fa-layer-group"></i>Filtrera på nivå:</label
      >
      <select id="level" [(ngModel)]="selectedLevel" (change)="onLevelChange()">
        <option value="">Alla nivåer</option>
        <option *ngFor="let level of levels" [value]="level">
          {{ level }}
        </option>
      </select>
    </div>

    <!-- Sortering -->
    <div class="filter-group">
      <label for="sort"><i class="fas fa-sort"></i>Sortera efter:</label>
      <select id="sort" [(ngModel)]="sortBy" (change)="onSort()">
        <option value="courseCode">Kurskod</option>
        <option value="courseName">Kursnamn</option>
        <option value="points">Poäng</option>
        <option value="subject">Ämne</option>
      </select>
    </div>

    <!-- Rensa filter -->
    <button (click)="clearFilters()" class="clear-btn">Rensa filter</button>
  </div>

  <!-- Kurslista -->
  <div *ngIf="!loading" class="courses-grid">
    <div *ngFor="let course of filteredCourses" class="course-card">
      <div class="course-header">
        <h3>{{ course.courseCode }}</h3>
        <span class="points">{{ course.points }} hp</span>
      </div>

      <h4 class="course-name">{{ course.courseName }}</h4>

      <div class="course-details">
        <p>
          <strong><i class="fas fa-tag"></i> Ämne:</strong> {{ course.subject }}
        </p>
        <p>
          <strong><i class="fas fa-layer-group"></i> Nivå:</strong>
          {{ course.level }}
        </p>
        <p>
          <strong><i class="fas fa-arrow-up"></i> Progression:</strong>
          {{ course.progression }}
        </p>
        <p>
          <strong><i class="fas fa-building"></i> Institution:</strong>
          {{ course.institutionCode }}
        </p>
      </div>
      <button
        (click)="addToSaved(course)"
        [class]="
          isCourseSaved(course.courseCode) ? 'save-btn saved' : 'save-btn'
        "
        [disabled]="isCourseSaved(course.courseCode)"
      >
        <i
          [class]="
            isCourseSaved(course.courseCode)
              ? 'fas fa-check'
              : 'fas fa-bookmark'
          "
        ></i>
        {{ isCourseSaved(course.courseCode) ? "Sparad" : "Spara kurs" }}
      </button>
    </div>
  </div>

  <!-- Statistik -->
  <div *ngIf="!loading" class="stats">
    <p>Visar {{ filteredCourses.length }} av {{ courses.length }} kurser</p>
  </div>
</div>
